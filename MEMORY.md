# Basalt Project Memory

## App Icon Generation

The Basalt app icon is the **block-letter "B"** from the CLI's ANSI Shadow
figlet banner, rendered as pixel-art with the same two-tone anthracite
gradient.

### Source art

The icon is derived from this ASCII art (the first column of the full
`BASALT` banner in `CLI/main.cpp` → `ShowBanner()`):

```
██████╗
██╔══██╗
██████╔╝
██╔══██╗
██████╔╝
╚═════╝
```

Each character maps to a colored pixel block:
- `█` → block face color (lighter anthracite)
- `╔╗╚╝═║` → shadow/edge color (darker anthracite)

### Color scheme

Vertical gradient per row (top = lighter, bottom = darker), matching the
ANSI 256-color codes used in the CLI banner:

| Row | Block (face) | Shadow (edge) | ANSI block | ANSI shadow |
|-----|-------------|---------------|------------|-------------|
| 0   | rgb(138,138,138) | rgb(98,98,98)  | 245 | 241 |
| 1   | rgb(118,118,118) | rgb(88,88,88)  | 243 | 240 |
| 2   | rgb(98,98,98)    | rgb(78,78,78)  | 241 | 239 |
| 3   | rgb(88,88,88)    | rgb(68,68,68)  | 240 | 238 |
| 4   | rgb(78,78,78)    | rgb(58,58,58)  | 239 | 237 |
| 5   | rgb(68,68,68)    | rgb(48,48,48)  | 238 | 236 |

Background: `rgb(28, 26, 32)` — very dark, slightly violet-tinted black.

### Rendering parameters

- **Cell aspect ratio**: 64×116 px per character (≈1:1.8, matching terminal)
- **Border**: 18% of canvas side length
- **Background**: rounded rectangle, corner radius = canvas/12, margin = canvas/30
- **Downsampling**: LANCZOS from high-res grid to target size
- **No cast shadow, no accent stripe** — depth comes purely from the
  two-tone block/shadow distinction per row

### Generated files (`Resources/Icons/`)

| File | Size | Use |
|------|------|-----|
| `basalt-icon-1024.png` | 1024×1024 | Source / marketing |
| `basalt-icon-512.png` | 512×512 | macOS @2x |
| `basalt-icon-256.png` | 256×256 | macOS / Windows |
| `basalt-icon-128.png` | 128×128 | macOS |
| `basalt-icon-64.png` | 64×64 | macOS @2x / Windows |
| `basalt-icon-32.png` | 32×32 | macOS / Windows |
| `basalt-icon-16.png` | 16×16 | macOS / Windows |
| `Basalt.icns` | multi-res | macOS app bundle (`CFBundleIconFile`) |
| `basalt.ico` | 16–256 | Windows executable resource |

### How to regenerate

All icons are generated by a Python/Pillow script. The last working version
is in the git history of commit `f881886`. To regenerate after changes:

```bash
# 1. Edit the render_icon() function or b_art / color tables
# 2. Run the Python script (inline or extracted to a file)
# 3. Rebuild .icns:
mkdir -p /tmp/basalt.iconset
cp Resources/Icons/basalt-icon-16.png   /tmp/basalt.iconset/icon_16x16.png
cp Resources/Icons/basalt-icon-32.png   /tmp/basalt.iconset/icon_16x16@2x.png
cp Resources/Icons/basalt-icon-32.png   /tmp/basalt.iconset/icon_32x32.png
cp Resources/Icons/basalt-icon-64.png   /tmp/basalt.iconset/icon_32x32@2x.png
cp Resources/Icons/basalt-icon-128.png  /tmp/basalt.iconset/icon_128x128.png
cp Resources/Icons/basalt-icon-256.png  /tmp/basalt.iconset/icon_128x128@2x.png
cp Resources/Icons/basalt-icon-256.png  /tmp/basalt.iconset/icon_256x256.png
cp Resources/Icons/basalt-icon-512.png  /tmp/basalt.iconset/icon_256x256@2x.png
cp Resources/Icons/basalt-icon-512.png  /tmp/basalt.iconset/icon_512x512.png
cp Resources/Icons/basalt-icon-1024.png /tmp/basalt.iconset/icon_512x512@2x.png
iconutil -c icns /tmp/basalt.iconset -o Resources/Icons/Basalt.icns
rm -rf /tmp/basalt.iconset
# 4. Rebuild .ico with the Python struct-based create_ico() function
# 5. Rebuild the app: bash Basalt/build.sh
# 6. Refresh Finder cache:
#    lsregister -f Basalt/build/Basalt.app && killall Finder
```

## CLI Banner

The CLI banner (`basalt-cli --help`, `--version`, or no args) uses the full
`BASALT` text in ANSI Shadow figlet style with the same anthracite gradient.
The tagline "encrypted volume management" is rendered in violet (ANSI 99).

- **Implementation**: `CLI/main.cpp` → `ShowBanner()`, `TerminalSupportsColor()`
- **Color output**: only when stderr is a TTY (`isatty()` on Unix,
  `ENABLE_VIRTUAL_TERMINAL_PROCESSING` on Windows 10+)
- **Fallback**: plain UTF-8 block characters without ANSI escapes
